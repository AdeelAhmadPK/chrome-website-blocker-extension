import{r as i,j as e,a as N}from"./index-YaJMB3Al.js";import{c as m,F as S,_ as u}from"./FaviconImage-vEVGwqce.js";import{D as E,g as x,e as _,c as I}from"./index-D_hri1Jd.js";function M(){const[t,l]=i.useState(E),[n,g]=i.useState(""),[f,h]=i.useState(0);i.useEffect(()=>{x().then(l),chrome.tabs.query({active:!0,currentWindow:!0},s=>{var r;const a=((r=s[0])==null?void 0:r.url)??"";try{const o=new URL(a).hostname;g(o.startsWith("www.")?o.slice(4):o)}catch{}}),chrome.runtime.sendMessage({type:"GET_FOCUS_STATE"},s=>{s!=null&&s.state&&l(a=>({...a,focusMode:s.state}))})},[]),i.useEffect(()=>{const s=t.focusMode;if(!s.isActive||!s.phaseEndsAt){h(0);return}const a=()=>h(Math.max(0,Math.round((s.phaseEndsAt-Date.now())/1e3)));a();const r=setInterval(a,1e3);return()=>clearInterval(r)},[t.focusMode.isActive,t.focusMode.phaseEndsAt]);const d=()=>x().then(l),p=async()=>{const{updateSettings:s}=await u(async()=>{const{updateSettings:a}=await import("./index-D_hri1Jd.js").then(r=>r.k);return{updateSettings:a}},[]);await s({blockingEnabled:!t.settings.blockingEnabled}),chrome.runtime.sendMessage({type:"REBUILD_RULES"}),d()},y=async()=>{if(!n||t.blockedItems.find(r=>r.url===n))return;const{updateBlockedItems:a}=await u(async()=>{const{updateBlockedItems:r}=await import("./index-D_hri1Jd.js").then(o=>o.k);return{updateBlockedItems:r}},[]);await a([...t.blockedItems,{id:I(),url:n,type:"domain",screenTimeToday:0,createdAt:Date.now()}]),d()},k=()=>{chrome.runtime.sendMessage({type:"START_FOCUS"},()=>d())},j=()=>{chrome.runtime.sendMessage({type:"STOP_FOCUS"},()=>d())},w=()=>{chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")}),window.close()},v=n&&t.blockedItems.some(s=>s.url===n),{focusMode:c}=t;return e.jsxs("div",{className:"font-sans bg-white dark:bg-slate-900 text-slate-900 dark:text-white",style:{width:320},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-primary-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2L3 7v7c0 5 3.7 10 9 11.4C17.3 24 21 19 21 14V7l-9-5z"})})}),e.jsx("span",{className:"font-semibold text-sm",children:"SiteBlocker Pro"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Blocking"}),e.jsx("button",{onClick:p,className:m("relative inline-flex h-5 w-9 items-center rounded-full transition-colors",t.settings.blockingEnabled?"bg-primary-500":"bg-gray-300"),children:e.jsx("span",{className:m("inline-block h-3 w-3 transform rounded-full bg-white shadow-sm transition-transform",t.settings.blockingEnabled?"translate-x-5":"translate-x-1")})})]})]}),n&&e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(S,{domain:n,size:18}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:n})]}),v?e.jsx("span",{className:"badge bg-red-100 text-red-700 text-xs flex-shrink-0",children:"Blocked"}):e.jsx("button",{onClick:y,className:"text-xs btn-primary py-1 px-2 flex-shrink-0",children:"Block"})]})}),e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Focus Mode"}),c.isActive&&e.jsx("span",{className:m("badge text-xs",c.phase==="work"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:c.phase==="work"?"Focus":"Break"})]}),c.isActive?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-xl font-bold text-gray-900 dark:text-white",children:_(f)}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Session ",c.currentSession," of ",c.totalSessions]})]}),e.jsx("button",{onClick:j,className:"btn-secondary text-xs py-1",children:"Stop"})]}):e.jsxs("button",{onClick:k,className:"btn-primary w-full text-xs py-2",children:["Start Focus Session (",t.focusMode.workMinutes,"m)"]})]}),e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[t.blockedItems.length," site",t.blockedItems.length!==1?"s":""," blocked"]}),e.jsxs("span",{children:[t.insights.length," domains tracked"]})]})}),e.jsx("div",{className:"px-4 py-3",children:e.jsx("button",{onClick:w,className:"btn-secondary w-full text-sm",children:"Open Dashboard"})})]})}x().then(t=>{t.settings.theme==="dark"&&document.documentElement.classList.add("dark")});const b=document.getElementById("root");b&&N(b).render(e.jsx(M,{}));
