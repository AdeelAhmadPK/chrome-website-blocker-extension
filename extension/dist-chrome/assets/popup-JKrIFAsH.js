import{r as d,j as e,a as D}from"./index-B8oZa9HQ.js";import{c,F as y,_ as b}from"./preload-helper-zRDGdip7.js";import{D as F,g as p,e as R,c as v}from"./index-CJMINZqK.js";function m(s){return s<1?"<1m":s<60?`${Math.round(s)}m`:`${Math.floor(s/60)}h ${Math.round(s%60)}m`}function U(){const[s,x]=d.useState(F),[r,w]=d.useState(""),[N,f]=d.useState(0),[u,M]=d.useState("home");d.useEffect(()=>{p().then(x),chrome.tabs.query({active:!0,currentWindow:!0},t=>{var i;const a=((i=t[0])==null?void 0:i.url)??"";try{const n=new URL(a).hostname;w(n.startsWith("www.")?n.slice(4):n)}catch{}}),chrome.runtime.sendMessage({type:"GET_FOCUS_STATE"},t=>{t!=null&&t.state&&x(a=>({...a,focusMode:t.state}))})},[]),d.useEffect(()=>{const t=s.focusMode;if(!t.isActive||!t.phaseEndsAt){f(0);return}const a=()=>f(Math.max(0,Math.round((t.phaseEndsAt-Date.now())/1e3)));a();const i=setInterval(a,1e3);return()=>clearInterval(i)},[s.focusMode.isActive,s.focusMode.phaseEndsAt]);const o=()=>p().then(x),S=async()=>{const{updateSettings:t}=await b(async()=>{const{updateSettings:a}=await import("./index-CJMINZqK.js").then(i=>i.k);return{updateSettings:a}},[]);await t({blockingEnabled:!s.settings.blockingEnabled}),chrome.runtime.sendMessage({type:"REBUILD_RULES"}),o()},L=async()=>{if(!r||s.blockedItems.find(i=>i.url===r))return;const{updateBlockedItems:a}=await b(async()=>{const{updateBlockedItems:i}=await import("./index-CJMINZqK.js").then(n=>n.k);return{updateBlockedItems:i}},[]);await a([...s.blockedItems,{id:v(),url:r,type:"domain",screenTimeToday:0,createdAt:Date.now()}]),o()},I=async()=>{if(!r)return;const{updateBlockedItems:t}=await b(async()=>{const{updateBlockedItems:i}=await import("./index-CJMINZqK.js").then(n=>n.k);return{updateBlockedItems:i}},[]);if(s.blockedItems.find(i=>i.url===r)){const i=s.blockedItems.map(n=>n.url===r?{...n,dailyLimitMinutes:n.dailyLimitMinutes??60,limitOnly:!0}:n);await t(i)}else await t([...s.blockedItems,{id:v(),url:r,type:"domain",screenTimeToday:0,dailyLimitMinutes:60,limitOnly:!0,createdAt:Date.now()}]);o()},E=()=>{chrome.runtime.sendMessage({type:"START_FOCUS"},()=>o())},T=()=>{chrome.runtime.sendMessage({type:"STOP_FOCUS"},()=>o())},_=()=>{chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")}),window.close()},B=!!r&&s.blockedItems.some(t=>t.url===r&&!t.limitOnly),O=!!r&&s.blockedItems.some(t=>t.url===r&&t.limitOnly),{focusMode:l}=s,C=new Date().toISOString().slice(0,10),h=s.insights.filter(t=>t.date===C),g=h.reduce((t,a)=>t+a.totalMinutes,0),j=[...h].sort((t,a)=>a.totalMinutes-t.totalMinutes).slice(0,3),A=s.blockedItems.filter(t=>t.dailyLimitMinutes!==void 0&&t.screenTimeToday>=t.dailyLimitMinutes).length;return e.jsxs("div",{className:"font-sans bg-white dark:bg-slate-900 text-slate-900 dark:text-white flex flex-col",style:{width:340,minHeight:480},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-primary-600 to-primary-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2L3 7v7c0 5 3.7 10 9 11.4C17.3 24 21 19 21 14V7l-9-5z"})})}),e.jsx("span",{className:"font-bold text-sm text-white",children:"SiteBlocker Pro"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/70",children:"Blocking"}),e.jsx("button",{onClick:S,className:c("relative inline-flex h-5 w-9 items-center rounded-full transition-colors",s.settings.blockingEnabled?"bg-white/30":"bg-black/20"),children:e.jsx("span",{className:c("inline-block h-3 w-3 transform rounded-full bg-white shadow transition-transform",s.settings.blockingEnabled?"translate-x-5":"translate-x-1")})})]})]}),r&&e.jsx("div",{className:"px-4 py-2.5 border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-slate-800/50",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(y,{domain:r,size:18}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800 dark:text-gray-200 truncate",children:r}),(()=>{const t=h.find(a=>a.domain===r||a.domain===`www.${r}`);return t?e.jsxs("div",{className:"text-xs text-gray-400",children:[m(t.totalMinutes)," today"]}):null})()]})]}),e.jsx("div",{className:"flex items-center gap-1 flex-shrink-0",children:B?e.jsx("span",{className:"badge bg-red-100 text-red-700 text-xs",children:"Blocked"}):O?e.jsx("span",{className:"badge bg-orange-100 text-orange-700 text-xs",children:"Limited"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:L,className:"text-xs bg-red-500 hover:bg-red-600 text-white px-2.5 py-1 rounded-md font-medium transition-colors",children:"Block"}),e.jsx("button",{onClick:I,className:"text-xs bg-orange-400 hover:bg-orange-500 text-white px-2.5 py-1 rounded-md font-medium transition-colors",children:"Limit"})]})})]})}),e.jsx("div",{className:"flex border-b border-gray-100 dark:border-gray-800",children:["home","sites"].map(t=>e.jsx("button",{onClick:()=>M(t),className:c("flex-1 py-2 text-xs font-semibold uppercase tracking-wide transition-colors",u===t?"text-primary-600 border-b-2 border-primary-500 bg-primary-50/50":"text-gray-400 hover:text-gray-600"),children:t==="home"?"Overview":"Blocked Sites"},t))}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[u==="home"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 border-b border-gray-100 dark:border-gray-800",children:[{label:"Browsing",value:m(g)},{label:"Blocked",value:String(s.blockedItems.filter(t=>!t.limitOnly).length)},{label:"Limits hit",value:String(A)}].map((t,a)=>e.jsxs("div",{className:c("flex flex-col items-center py-3",a<2&&"border-r border-gray-100 dark:border-gray-800"),children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t.value}),e.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:t.label})]},t.label))}),e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Focus Mode"}),l.isActive&&e.jsx("span",{className:c("badge text-xs",l.phase==="work"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:l.phase==="work"?"ðŸŽ¯ Focusing":"â˜• Break"})]}),l.isActive?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-2xl font-bold",children:R(N)}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Session ",l.currentSession," of ",l.totalSessions]})]}),e.jsx("button",{onClick:T,className:"btn-secondary text-xs py-1.5 px-3",children:"Stop"})]}):e.jsxs("button",{onClick:E,className:"btn-primary w-full text-sm py-2",children:["â–¶ Start Focus (",s.focusMode.workMinutes,"m)"]})]}),e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wide mb-2",children:"Top Sites Today"}),j.length>0?e.jsx("div",{className:"space-y-2",children:j.map(t=>{const a=g>0?Math.min(100,t.totalMinutes/g*100):0;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{domain:t.domain,size:14}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-0.5",children:[e.jsx("span",{className:"truncate text-gray-700 dark:text-gray-300",children:t.domain}),e.jsx("span",{className:"text-gray-400 ml-1 flex-shrink-0",children:m(t.totalMinutes)})]}),e.jsx("div",{className:"h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-400 rounded-full transition-all",style:{width:`${a}%`}})})]})]},t.domain)})}):e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"No browsing tracked today yet"})]})]}),u==="sites"&&e.jsx("div",{className:"divide-y divide-gray-50 dark:divide-gray-800",children:s.blockedItems.length===0?e.jsx("div",{className:"text-center py-8 text-gray-400 text-xs",children:"No blocked sites yet"}):s.blockedItems.map(t=>{const a=t.dailyLimitMinutes!==void 0&&t.screenTimeToday>=t.dailyLimitMinutes;return e.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2.5",children:[e.jsx(y,{domain:t.url,size:16}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-800 dark:text-gray-200 truncate",children:t.url}),t.dailyLimitMinutes&&e.jsxs("div",{className:"text-xs text-gray-400",children:[m(t.screenTimeToday)," / ",m(t.dailyLimitMinutes)]})]}),a&&e.jsx("span",{className:"badge bg-red-100 text-red-600 text-[10px]",children:"Limit hit"}),!t.limitOnly&&!a&&e.jsx("span",{className:"badge bg-gray-100 text-gray-500 text-[10px]",children:"Blocked"}),t.limitOnly&&!a&&e.jsx("span",{className:"badge bg-orange-50 text-orange-500 text-[10px]",children:"Limited"})]},t.id)})})]}),e.jsx("div",{className:"px-4 py-2.5 border-t border-gray-100 dark:border-gray-800",children:e.jsx("button",{onClick:_,className:"btn-secondary w-full text-sm py-2",children:"Open Dashboard â†’"})})]})}p().then(s=>{s.settings.theme==="dark"&&document.documentElement.classList.add("dark")});const k=document.getElementById("root");k&&D(k).render(e.jsx(U,{}));
